	SUBROUTINE TRANSL(LTR)

C
C   THIS SUBROUTINE PRODUCES THE OUTPUT TEXT ON A CRT.
C    IT USES THE SIMPLE FORMATTING RULES DESCRIBED IN THE
C    TEXT.
C


	INTEGER SPFLAG,ELMHAT,ELMOUT
	DIMENSION LTRMAP(400),IALPH(70),IBLANK(400)
	DIMENSION IELMST(400),ILAMI(16),ILAMX(6)

	COMMON/BLKTRN/LTRMAP,IBLANK, IALPH
	COMMON/BLKLAM/IELMST,ILAMI,ILAMX

	CHARACTER*1 ISPACE  
	DATA ISPACE/' '/
	DATA SPFLAG/0/
	DATA NCHAR/0/

C	DETERMINE IF A CSP,WSP, OR PAUSE TO MARK TRASITION
C	HAS OCCURED; IF SO LTR IS READY FOR OUTPUT:

	ELMHAT=ILAMI(IELMST(LTR))
	IXL=ILAMX(ELMHAT)
	IF (IXL.EQ.IXLAST) GO TO 700
	IF ((IXL.EQ. 1).AND.(LSTELM.GE. 4)) GO TO 10
	IF ((IXL.EQ. 0).AND.(LSTELM.LE. 2)) GO TO 700
	GO TO 700 

10	LTRHAT=LSTLTR
	LTROUT=IALPH(LTRMAP(LTRHAT))
	NBLANK=IBLANK(LTRHAT)
	ELMOUT=ILAMI(IELMST(LTRHAT))
	GO TO 40 

	PRINT 5000,ELMOUT
5000	FORMAT(1X,I1,S)
	NCHAR=NCHAR+1

40	CONTINUE
	IF(LTRMAP(LTRHAT).EQ.43) GO TO 50
	IF(LTRMAP(LTRHAT).LE.44) GO TO 100
	IF(LTRMAP(LTRHAT).LE.46) GO TO 200
	IF(LTRMAP(LTRHAT).LE.60) GO TO 300
	IF(LTRMAP(LTRHAT).EQ.61) GO TO 400
	IF(LTRMAP(LTRHAT).EQ.66) GO TO 500
	GO TO 550

50	IF(SPFLAG.EQ.0)	GO TO 100

	NCHAR=0
	PRINT 1500,LTROUT
1500	FORMAT(2X,A1,/)
	SPFLAG=1
	GO TO 600

100	NCHAR=NCHAR+1
	PRINT 1000,LTROUT
1000	FORMAT(1X,A1,S)
	SPFLAG=0
	IF(NBLANK.EQ.0)	GO TO 110
	SPFLAG=1
	DO	110	I=1,NBLANK
	NCHAR=NCHAR+1
	PRINT 1000,ISPACE
110	CONTINUE
	GO TO 600


200	NCHAR=NCHAR+2
	PRINT 1100,LTROUT
1100	FORMAT(1X,A2,$)
	SPFLAG=0
	IF (NBLANK.EQ.0) GO TO 210
	SPFLAG=1
	DO 210 I=1,NBLANK
	NCHAR=NCHAR+1
	PRINT 1000,ISPACE
210	CONTINUE
	GO TO 600

300	NCHAR=NCHAR+4

	PRINT 1200,LTROUT
1200	FORMAT(2X,A2,2X,$)
	SPFLAG=1
	IF (NBLANK.EQ.0) GO TO 310
	DO 310 I=1,NBLANK
	NCHAR=NCHAR+1
	PRINT 1000,ISPACE
310	CONTINUE
	GO TO 600

400	NCHAR=NCHAR+5

	PRINT 1300,LTROUT
1300	FORMAT(2X,A3,2X,$)
	SPFLAG=1
	GO TO 600

500	NCHAR=0
	PRINT 1400,LTROUT
1400	FORMAT(/,10X,A2,/,10X)
	SPFLAG=1
	GO TO 600

550	NCHAR=NCHAR+5
	PRINT 1700,LTROUT
1700	FORMAT(2X,A3,2X,$)
	SPFLAG=0
	IF(NBLANK.EQ.0) GO TO 560
	SPFLAG=1
	DO 560 I=1,NBLANK
	NCHAR=NCHAR+1
	PRINT 1000,ISPACE
560	CONTINUE

600	IF (NCHAR .LT. 52) GO TO 700

	PRINT 1600
1600	FORMAT(/,10X)
	NCHAR=0

700	TXLAST=IXL
	LSTELM=ELMHAT
	LSTLTR=LTR

	RETURN
	END
