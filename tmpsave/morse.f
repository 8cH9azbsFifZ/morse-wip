	PROGRAM MORSE

	INTEGER ELMHAT, XHAT
	DIMENSION S1(512), S2(512), S3(512), S4(512)

	DATA RN/.1/
	DATA NP/0/

	CALL INITL
	CALL INPUTL

1  	DO 2 N1=1,512
	DO 3 N2=1,18
	CALL SIMSGI(X,ZSIG)
	CALL RCVR(ZSIG,ZRCV)
	CALL BPFDET(ZRCV,ZDET)
	NP=NP+1
	IF(NP.LT.40) GO TO 3
	NP=0

	CALL NOISE(ZDET,RN,Z)
	RN=0
	CALL PROCES(Z,RN,XHAT,PX,ELMHAT,LTRHAT)
3	CONTINUE

	N=N1
	CALL STATS(ZDET,Z,PX,XHAT,S1,S2,S3,S4,N)
2	CONTINUE

C	CALL DISPLA(S1,S2,S3,S4)

	GO TO 1
	STOP
	END 
