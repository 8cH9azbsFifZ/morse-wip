	SUBROUTINE BPFDET(ZIN, Z)

C
C       THIS SUBROUTINE IMPLEMENTS THE BANDPASS FILTER AND 
C       ENVELOPE DETECTOR FUNCTIONS. THE BPF IS A SIMPLE CASCADE
C       OF TWO 2-POLE DIGITAL RESONATORS AT A CENTER FREQ OF 
C       1000 HZ. THE LPF OF THE ENVELOPE DETECTOR IS A 
C       THREE - POLE CHEBYSCHEV 100 HZ LPF.
C
C


	DIMENSION A ( 4 )
	DATA A/ .000030051, 2.9507982, 2.90396345, -0.953135172/
	DATA CK1/1.37158/ , CK2/ 0.9409/, CG/ 0.0150/
	DATA C1 / 1.2726/ ,C2/ 0.8100/ , C / 0.1900/

C	OFF IS TWO 2 - POLE RESONATORS :   

	W3 = W2
	W2 = W1
	W1=C1*W2-C2*W3+C*ZIN
	X3=X2
	X2=X1
	X1=CK1*X2-CK2*X3+CG*W1
	ZBPF=X1

C	ENVELOPE DETECTOR (SQUARE-LAW):
C		sQUARE-

	XDET=SQRT(ZBPF**2)



C	LOW-PASS FILTER-

	Y3=Y2
	Y2=Y1
	Y1=Y0
	Y0=XDET*A(1)

	Z3=Z2
	Z2=Z1
	Z1=Z
	Z=Y0+3.*(Y1+Y2)+Y3
	Z=Z+A(2)*Z1-A(3)*Z2-A(4)*23

	RETURN
	END
