	SUBROUTINE TRANSL(LTR)

C
C   THIS SUBROUTINE PRODUCES THE OUTPUT TEXT ON A CRT.
C    IT USES THE SIMPLE FORMATTING RULES DESCRIBED IN THE
C    TEXT.
C


	INTEGER SPFLAG,ELMHAT
	DIMENSION LTRMAP(400),IBLANK(400)
	DIMENSION IELMST(400),ILAMI(16),ILAMX(6)

	COMMON/BLKTRN/LTRMAP,IBLANK, IALPH
	COMMON/BLKLAM/IELMST,ILAMI,ILAMX

	CHARACTER*70 IALPH
	CHARACTER*1 ISPACE  
	CHARACTER*1 LTROUT
	DATA ISPACE/' '/
	DATA SPFLAG/0/
	DATA NCHAR/0/
	DATA LSTLTR/5/
	DATA IXLAST/0/
	DATA LSTELM/6/

C	DETERMINE IF A CSP,WSP, OR PAUSE TO MARK TRASITION
C	HAS OCCURED; IF SO LTR IS READY FOR OUTPUT:


	ELMHAT=ILAMI(IELMST(LTR))
	IXL=ILAMX(ELMHAT)
C	PRINT 5, LTR, LSTLTR, IXL
C5	FORMAT('TRANSL LTR, LSTLTR, IXL:', I12, I12, I12)
C	NO CHANGE FROM LAST - CONTINUE 
	IF (IXL.EQ.IXLAST) GO TO 700

C	KEYSTATE = 1 AND LAST ELEMENT WAS CSP, WSP OR PAUSE => PRINT LETTER
	IF ((IXL.EQ. 1).AND.(LSTELM.GE. 4)) GO TO 10

C	KEYSTATE = 0  AND LAST ELEMENT WAS DIT OR DAH => SAVE LETTER STATE 
	IF ((IXL.EQ. 0).AND.(LSTELM.LE. 2)) GO TO 700
	GO TO 700 

C	LETTER OUT WILL BE LAST LETTER SAVED 
10	LTRHAT=LSTLTR
	I=LTRMAP(LTRHAT)
	LTROUT=IALPH(I:I+1)
	NBLANK=IBLANK(LTRHAT)
	ELMHAT=ILAMI(IELMST(LTRHAT))
	GO TO 40 
	GO TO 700

	PRINT 5000,ELMHAT,NCHAR, I, LTR, LTRHAT, LTROUT
5000	FORMAT('ELMHAT, NCHAR, I, LTR, LTRHAT, LTROUT:',
     &1X,I1,4(1X,I3),':',A1)
	NCHAR=NCHAR+1

40	CONTINUE
	IF(LTRMAP(LTRHAT).EQ.43) GO TO 50
	IF(LTRMAP(LTRHAT).LE.44) GO TO 100
	IF(LTRMAP(LTRHAT).LE.46) GO TO 200
	IF(LTRMAP(LTRHAT).LE.60) GO TO 300
	IF(LTRMAP(LTRHAT).EQ.61) GO TO 400
	IF(LTRMAP(LTRHAT).EQ.66) GO TO 500
	GO TO 550

50	IF(SPFLAG.EQ.0)	GO TO 100

C	LTRMAP(LTR) = 43 => PRINT "^" AND RESET LINE CHARACTER COUNTER 

	NCHAR=0
	PRINT 1500,LTROUT
1500	FORMAT(2X,A1,/)
	SPFLAG=1
	GO TO 600

C	LTRMAP(LTR) <= 44 => PRINTABLE SINGLE LETTERS & NUMBERS A..Z 0..9 AND ;:,%&^'

100	NCHAR=NCHAR+1
	PRINT 1000,LTROUT
1000	FORMAT(1X,A1,S)
	SPFLAG=0
	IF(NBLANK.EQ.0)	GO TO 111
	SPFLAG=1

C	PRINT ANY SPACES IN IBLANK BUFFER 
	DO 110 I=1,NBLANK
	NCHAR=NCHAR+1
	PRINT 1000,ISPACE
110     CONTINUE
111     CONTINUE
	GO TO 600

C	LTRMAP(LTR) <= 44 => PRINT AS or SN 
200	NCHAR=NCHAR+2
	PRINT 1100,LTROUT
1100	FORMAT(1X,A2,$)

	SPFLAG=0
	IF (NBLANK.EQ.0) GO TO 211
	SPFLAG=1

	DO 210 I=1,NBLANK
	NCHAR=NCHAR+1
	PRINT 1000,ISPACE
210     CONTINUE
211     CONTINUE
	GO TO 600

C	LTRMAP(LTR) <= 60 => PRINT 'NR','NO','GA','OK','AR','SK' PLUS 2 SPC
300	NCHAR=NCHAR+4

	PRINT 1200,LTROUT
1200	FORMAT(2X,A2,2X,$)

	SPFLAG=1
	IF (NBLANK.EQ.0) GO TO 311
	DO 310 I=1,NBLANK
	NCHAR=NCHAR+1
	PRINT 1000,ISPACE
310     CONTINUE
311     CONTINUE
	GO TO 600

C	LTRMAP(LTR) == 61 => PRINT 'IMI' 	
400	NCHAR=NCHAR+5

	PRINT 1300,LTROUT
1300	FORMAT(2X,A3,2X,$)
	SPFLAG=1
	GO TO 600

C	LTRMAP(LTR) == 66 => PRINT 'BT' 
500	NCHAR=0
	PRINT 1400,LTROUT
1400	FORMAT(/,10X,A2,/,10X)
	SPFLAG=1
	GO TO 600

C	LTRMAP(LTR) == 70 => PRINT 'EEE' 
550	NCHAR=NCHAR+5
	PRINT 1700,LTROUT
1700	FORMAT(2X,A3,2X,$)
	SPFLAG=0
	IF(NBLANK.EQ.0) GO TO 561
	SPFLAG=1
	DO 560 I=1,NBLANK
	NCHAR=NCHAR+1
	PRINT 1000,ISPACE
560	CONTINUE
561     CONTINUE

C	CHECK IF LINE CHARACTER COUNTER < 52 
600	IF (NCHAR .LT. 52) GO TO 700

C	PRINT LINE RETURN AND RESET LINE CHARACTER COUNTER 
	PRINT 1600
1600	FORMAT(/,10X)
	NCHAR=0

700	IXLAST=IXL
	LSTELM=ELMHAT
	LSTLTR=LTR

	RETURN
	END
